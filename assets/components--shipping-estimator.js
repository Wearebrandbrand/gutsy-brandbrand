if(!customElements.get("shipping-estimator")){class o extends HTMLElement{constructor(){super()}connectedCallback(){this.setupCountries(),this.submitButton=this.querySelector('[type="button"]'),this.submitButton.addEventListener("click",this.estimateShipping.bind(this)),this.results=this.querySelector(".shipping-estimator--results")}async estimateShipping(){const t=this.querySelector(".shipping-estimator-zip").value,e=this.querySelector(".shipping-estimator-country").value,s=this.querySelector(".shipping-estimator-province").value;this.submitButton.classList.add("loading");const i=await fetch(`${window.theme.routes.cart_url}/prepare_shipping_rates.json?shipping_address[zip]=${t}&shipping_address[country]=${e}&shipping_address[province]=${s}`,{method:"POST"});if(i.ok){const n=await this.getShippingRates(t,e,s);this.formatShippingRates(n)}else{const n=await i.json();this.formatError(n)}this.submitButton.classList.remove("loading")}async getShippingRates(t,e,s){const n=await(await fetch(`${window.theme.routes.cart_url}/async_shipping_rates.json?shipping_address[zip]=${t}&shipping_address[country]=${e}&shipping_address[province]=${s}`)).text();return n==="null"?this.getShippingRates(t,e,s):JSON.parse(n).shipping_rates}formatShippingRates(t){let e="",s="",i=window.theme.settings.money_with_currency_format||"${{amount}}";t.forEach(r=>{e+=`<li>${r.presentment_name}: ${formatMoney(parseFloat(r.price)*100,i)}</li>`}),t.length===0?s=window.theme.strings.shippingEstimatorNoResults:t.length===1?s=window.theme.strings.shippingEstimatorOneResult:s=window.theme.strings.shippingEstimatorMultipleResults;const n=`
        <p>${s}</p>
        ${e===""?"":`<ul>${e}</ul>`}
      `;this.results.innerHTML="",this.results.insertAdjacentHTML("beforeend",n)}formatError(t){let e="";Object.keys(t).forEach(i=>{e+=`<li>${i} ${t[i]}</li>`});const s=`
        <p>${window.theme.strings.shippingEstimatorError}</p>
        <ul>${e}</ul>
      `;this.results.innerHTML="",this.results.insertAdjacentHTML("beforeend",s)}setupCountries(){if(Shopify&&Shopify.CountryProvinceSelector){let t=this.dataset.formId;new Shopify.CountryProvinceSelector(`shipping-estimator-country-${t}`,`shipping-estimator-province-${t}`,{hideElement:`shipping-estimator-province-wrapper-${t}`})}}}customElements.define("shipping-estimator",o)}
//# sourceMappingURL=components--shipping-estimator.js.map
