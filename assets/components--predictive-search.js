if(!customElements.get("search-form")){class r extends HTMLElement{constructor(){super()}connectedCallback(){this.is_drawer=this.dataset.drawer,this.drawer=this.closest("#Search-Drawer"),this.form=this.querySelector("form"),this.button=document.querySelectorAll(".thb-quick-search"),this.input=this.querySelector(".search-field"),this.defaultTab=this.querySelector(".side-panel-content--initial"),this.predictiveSearchResults=this.querySelector(".thb-predictive-search"),this.cc=this.querySelector(".searchform--click-capture"),this.setupEventListeners()}setupEventListeners(){var t;this.form.addEventListener("submit",this.onFormSubmit.bind(this)),this.input.addEventListener("input",debounce(e=>{this.onChange(e)},300).bind(this)),this.input.addEventListener("focus",debounce(e=>{this.onChange(e)},300).bind(this)),this.button.forEach((e,s)=>{e.addEventListener("click",i=>(i.preventDefault(),document.body.classList.add("open-cc"),this.is_drawer&&this.drawer.classList.add("active"),!1))}),(t=this.cc)==null||t.addEventListener("click",this.close.bind(this)),document.addEventListener("keyup",e=>{e.code&&e.code.toUpperCase()==="ESCAPE"&&this.close()})}getQuery(){return this.input.value.trim()}onChange(){const t=this.getQuery();if(!t.length){this.is_drawer||this.close();return}this.is_drawer||this.open(),this.predictiveSearchResults.classList.add("active"),this.getSearchResults(t)}onFormSubmit(t){this.getQuery().length||t.preventDefault()}onFocus(){const t=this.getQuery();if(!t.length){this.predictiveSearchResults.innerHTML="";return}this.getSearchResults(t)}getSearchResults(t){this.predictiveSearchResults.classList.add("loading"),fetch(`${theme.routes.predictive_search_url}?q=${encodeURIComponent(t)}&${encodeURIComponent("resources[type]")}=product,article,query,page&${encodeURIComponent("resources[limit]")}=10&section_id=predictive-search`).then(e=>{if(this.predictiveSearchResults.classList.remove("loading"),!e.ok){var s=new Error(e.status);throw s}return e.text()}).then(e=>{const s=new DOMParser().parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.renderSearchResults(s)}).catch(e=>{throw e})}renderSearchResults(t){this.predictiveSearchResults.innerHTML=t,this.is_drawer||this.predictiveSearchResults.querySelector("#search-results-submit").classList.remove("button"),this.predictiveSearchResults.querySelector("#search-results-submit").addEventListener("click",()=>{this.form.submit()})}close(){this.predictiveSearchResults.setAttribute("inert",""),document.body.classList.remove("open-search")}open(){document.body.classList.add("open-search"),this.predictiveSearchResults.removeAttribute("inert")}}customElements.define("search-form",r)}
//# sourceMappingURL=components--predictive-search.js.map
