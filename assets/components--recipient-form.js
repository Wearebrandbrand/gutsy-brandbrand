customElements.get("recipient-form")||customElements.define("recipient-form",class extends HTMLElement{constructor(){var e,t,r;super(),this.checkboxInput=this.querySelector(`#Recipient-Checkbox-${this.dataset.sectionId}`),this.checkboxInput.disabled=!1,this.hiddenControlField=this.querySelector(`#Recipient-Control-${this.dataset.sectionId}`),this.hiddenControlField.disabled=!0,this.emailInput=this.querySelector(`#Recipient-email-${this.dataset.sectionId}`),this.nameInput=this.querySelector(`#Recipient-name-${this.dataset.sectionId}`),this.messageInput=this.querySelector(`#Recipient-message-${this.dataset.sectionId}`),this.errorMessageWrapper=this.querySelector(".product-form__recipient-error-message-wrapper"),this.errorMessageList=(e=this.errorMessageWrapper)==null?void 0:e.querySelector("ul"),this.errorMessage=(t=this.errorMessageWrapper)==null?void 0:t.querySelector(".error-message"),this.defaultErrorHeader=(r=this.errorMessage)==null?void 0:r.innerText,this.currentProductVariantId=this.dataset.productVariantId,this.addEventListener("change",this.onChange.bind(this))}connectedCallback(){document.addEventListener("cart:item-added",this.onCartAdded.bind(this)),document.addEventListener("product:variant-change",this.onVariantChange.bind(this)),document.addEventListener("product:variant-error",this.onVariantError.bind(this))}onCartAdded(e){e.detail.product.id.toString()===this.currentProductVariantId&&this.resetRecipientForm()}onVariantChange(e){e.detail.sectionId===this.dataset.sectionId&&(this.currentProductVariantId=e.detail.variant.id.toString())}onVariantError(e){e.detail.source==="product-form"&&e.detail.productVariantId.toString()===this.currentProductVariantId&&this.displayErrorMessage(e.detail.message,e.detail.errors)}onChange(){this.checkboxInput.checked||(this.clearInputFields(),this.clearErrorMessage())}clearInputFields(){this.emailInput.value="",this.nameInput.value="",this.messageInput.value=""}displayErrorMessage(e,t){if(this.clearErrorMessage(),this.errorMessageWrapper.hidden=!1,typeof t=="object")return this.errorMessage.innerText=this.defaultErrorHeader,Object.entries(t).forEach(([r,s])=>{const o=`RecipientForm-${r}-error-${this.dataset.sectionId}`,c=`#Recipient-${r}-${this.dataset.sectionId}`,a=this.querySelector(`${c}`),d=`${(a==null?void 0:a.getAttribute("placeholder"))||r} ${s}`,i=this.querySelector(`#${o}`),h=i==null?void 0:i.querySelector(".error-message");if(!h)return;this.errorMessageList&&this.errorMessageList.appendChild(this.createErrorListItem(c,d)),h.innerText=`${d}.`,i.classList.remove("hidden");const n=this[`${r}Input`];n&&(n.setAttribute("aria-invalid",!0),n.setAttribute("aria-describedby",o))});this.errorMessage.innerText=t}createErrorListItem(e,t){const r=document.createElement("li"),s=document.createElement("a");return s.setAttribute("href",e),s.innerText=t,r.appendChild(s),r.className="error-message",r}clearErrorMessage(){this.errorMessageWrapper.hidden=!0,this.errorMessageList&&(this.errorMessageList.innerHTML=""),this.querySelectorAll(".recipient-fields .form__message").forEach(e=>{e.classList.add("hidden");const t=e.querySelector(".error-message");t&&(t.innerText="")}),[this.emailInput,this.messageInput,this.nameInput].forEach(e=>{e.setAttribute("aria-invalid",!1),e.removeAttribute("aria-describedby")})}resetRecipientForm(){this.checkboxInput.checked&&(this.checkboxInput.checked=!1,this.clearInputFields(),this.clearErrorMessage())}});
//# sourceMappingURL=components--recipient-form.js.map
