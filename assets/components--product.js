if(!customElements.get("variant-selects")){class d extends HTMLElement{constructor(){super(),this.sticky=this.dataset.sticky,this.updateUrl=this.dataset.updateUrl==="true",this.isDisabledFeature=this.dataset.isDisabled,this.addEventListener("change",this.onVariantChange),this.other=Array.from(document.querySelectorAll("variant-selects")).filter(t=>t!=this),this.productWrapper=this.closest(".thb-product-detail"),this.productSlider=this.productWrapper.querySelector(".product-images"),this.hideVariants=this.dataset.hideVariants==="true"}connectedCallback(){this.updateOptions(),this.updateMasterId(),this.setDisabled(),this.setImageSet()}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updatePickupAvailability(),this.removeErrorMessage(),this.updateVariantText(),this.setDisabled(),this.currentVariant?(this.updateMedia(),this.updateUrl&&this.updateURL(),this.updateVariantInput(),this.renderProductInfo()):(this.toggleAddButton(!0,"",!0),this.setUnavailable()),this.updateOther(),dispatchCustomEvent("product:variant-change",{variant:this.currentVariant,sectionId:this.dataset.section})}updateOptions(){this.fieldsets=Array.from(this.querySelectorAll("fieldset")),this.options=[],this.fieldsets.forEach((t,e)=>{t.querySelector("select")?this.options.push(t.querySelector("select").value):t.querySelectorAll("input").length&&this.options.push(t.querySelector("input:checked").value)})}updateVariantText(){Array.from(this.querySelectorAll("fieldset")).forEach((e,i)=>{let s=e.querySelector(".form__label__value");s&&(s.innerHTML=this.options[i])})}updateMasterId(){this.currentVariant=this.getVariantData().find(t=>!t.options.map((e,i)=>this.options[i]===e).includes(!1))}updateOther(){if(this.dataset.updateUrl!=="false"&&this.other.length){let t=this.other[0].querySelectorAll("fieldset"),e=Array.from(t);this.options.forEach((i,s)=>{e[s].querySelector("select")?e[s].querySelector("select").value=i:e[s].querySelectorAll("input").length&&(e[s].querySelector(`input[value='${i}']`).checked=!0)}),this.other[0].updateOptions(),this.other[0].updateMasterId(),this.other[0].updateVariantText(),this.other[0].setDisabled()}}updateMedia(){if(!this.currentVariant||!this.currentVariant.featured_media)return;let t=this.productWrapper.querySelector(".product-thumbnail-container");this.setActiveMedia(`#Slide-${this.dataset.section}-${this.currentVariant.featured_media.id}`,`#Thumb-${this.dataset.section}-${this.currentVariant.featured_media.id}`,this.productSlider,t)}setActiveMedia(t,e,i,s){let r=Flickity.data(i),n=i.querySelector(t);if(r&&this.hideVariants){if(i.querySelector(".product-images__slide.is-initial-selected")&&i.querySelector(".product-images__slide.is-initial-selected").classList.remove("is-initial-selected"),[].forEach.call(i.querySelectorAll(".product-images__slide-item--variant"),function(o){o.classList.remove("is-active")}),n.classList.add("is-active"),n.classList.add("is-initial-selected"),this.setImageSetMedia(),s){let o=s.querySelector(e);s.querySelector(".product-thumbnail.is-initial-selected")&&s.querySelector(".product-thumbnail.is-initial-selected").classList.remove("is-initial-selected"),[].forEach.call(s.querySelectorAll(".product-images__slide-item--variant"),function(c){c.classList.remove("is-active")}),o.classList.add("is-active"),o.classList.add("is-initial-selected")}i.reInit(this.imageSetIndex),i.selectCell(t)}else r&&i.selectCell(t)}updateURL(){!this.currentVariant||this.dataset.updateUrl==="false"||window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateShareUrl(){const t=document.getElementById(`Share-${this.dataset.section}`);t&&t.updateUrl(`${window.shopUrl}${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment`).forEach(e=>{const i=e.querySelector('input[name="id"]');i.value=this.currentVariant.id,i.dispatchEvent(new Event("change",{bubbles:!0}))})}updatePickupAvailability(){const t=document.querySelector(".pickup-availability-wrapper");t&&(this.currentVariant&&this.currentVariant.available?t.fetchAvailability(this.currentVariant.id):(t.removeAttribute("available"),t.innerHTML=""))}removeErrorMessage(){const t=this.closest("section");if(!t)return;const e=t.querySelector("product-form");e&&e.handleErrorMessage()}getSectionsToRender(){return[`price-${this.dataset.section}`,`price-${this.dataset.section}--sticky`,`product-image-${this.dataset.section}--sticky`,`inventory-${this.dataset.section}`,`sku-${this.dataset.section}`,`quantity-${this.dataset.section}`]}renderProductInfo(){let t=this.getSectionsToRender();fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then(e=>e.text()).then(e=>{const i=new DOMParser().parseFromString(e,"text/html");t.forEach(s=>{const r=document.getElementById(s),n=i.getElementById(s);n&&r&&(r.innerHTML=n.innerHTML);const o=document.getElementById(s),c=document.getElementById(s+"--sticky");o&&o.classList.remove("visibility-hidden"),c&&c.classList.remove("visibility-hidden")}),this.toggleAddButton(!this.currentVariant.available,window.theme.variantStrings.soldOut)})}toggleAddButton(t=!0,e=!1,i=!0){const s=document.getElementById(`product-form-${this.dataset.section}`);if(!s)return;const r=s.closest(".product-form").getAttribute("template"),n=document.querySelectorAll(".single-add-to-cart-button");n&&n.forEach(o=>{const c=o.querySelector(".single-add-to-cart-button--text");c&&(t?(o.setAttribute("disabled","disabled"),e&&(c.textContent=e)):(o.removeAttribute("disabled"),o.classList.remove("loading"),r!=null&&r.includes("pre-order")?c.textContent=window.theme.variantStrings.preOrder:c.textContent=window.theme.variantStrings.addToCart))})}setUnavailable(){const t=document.querySelectorAll(".single-add-to-cart-button"),e=document.getElementById(`price-${this.dataset.section}`),i=document.getElementById(`price-${this.dataset.section}--sticky`);t.forEach(s=>{const r=s.querySelector(".single-add-to-cart-button--text");s&&(r.textContent=window.theme.variantStrings.unavailable,s.classList.add("sold-out"))}),e&&e.classList.add("visibility-hidden"),i&&i.classList.add("visibility-hidden")}setDisabled(){if(this.isDisabledFeature!="true")return;const t=this.getVariantData();if(t){let e=!1;if(this.currentVariant)e=this.currentVariant.options.map((s,r)=>({value:s,index:`option${r+1}`}));else{let s=t.find(r=>r.option1===this.options[0]);if(s)e=[{value:this.options[0],index:"option1"},{value:s.option2,index:"option2"}];else return}const i=this.createAvailableOptionsTree(t,e);this.fieldsets.forEach((s,r)=>{const n=Object.values(i)[r];n&&(s.querySelector("select")?n.forEach((o,c)=>{o.isUnavailable?s.querySelector("option[value="+JSON.stringify(o.value)+"]").disabled=!0:s.querySelector("option[value="+JSON.stringify(o.value)+"]").disabled=!1}):s.querySelectorAll("input").length&&s.querySelectorAll("input").forEach((o,c)=>{o.classList.toggle("is-disabled",n[c].isUnavailable)}))})}return!0}getImageSetName(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-$/,"").replace(/^-/,"")}setImageSet(){if(!this.productSlider)return;let t=this.productSlider.querySelector("[data-set-name]");t&&(this.imageSetName=t.dataset.setName,this.imageSetIndex=this.querySelector('.product-form__input[data-handle="'+this.imageSetName+'"]').dataset.index,this.dataset.imageSetIndex=this.imageSetIndex,this.setImageSetMedia())}setImageSetMedia(){if(!this.imageSetIndex)return;let t=this.getImageSetName(this.currentVariant[this.imageSetIndex]),e=this.imageSetName+"_"+t,i=this.productWrapper.querySelectorAll(`.product-images__slide[data-set-name="${this.imageSetName}"]`),s=this.productWrapper.querySelectorAll(`.product-thumbnail[data-set-name="${this.imageSetName}"]`);this.hideVariants&&(this.productWrapper.querySelectorAll(".product-images__slide").forEach(r=>{r.dataset.group&&r.dataset.group!==e&&r.classList.remove("is-active")}),i.forEach(r=>{r.classList.toggle("is-active",r.dataset.group===e)}),this.productWrapper.querySelectorAll(".product-thumbnail").forEach(r=>{r.dataset.group&&r.dataset.group!==e&&r.classList.remove("is-active")}),s.forEach(r=>{r.classList.toggle("is-active",r.dataset.group===e)}))}createAvailableOptionsTree(t,e){return t.reduce((i,s)=>(Object.keys(i).forEach(r=>{if(s[r]===null)return;let n=i[r].find(u=>u.value===s[r]);typeof n>"u"&&(n={value:s[r],isUnavailable:!0},i[r].push(n));const o=e.find(({value:u,index:h})=>h==="option1"),c=e.find(({value:u,index:h})=>h==="option2");switch(r){case"option1":n.isUnavailable=n.isUnavailable&&s.available?!1:n.isUnavailable;break;case"option2":o&&s.option1===o.value&&(n.isUnavailable=n.isUnavailable&&s.available?!1:n.isUnavailable);break;case"option3":o&&s.option1===o.value&&c&&s.option2===c.value&&(n.isUnavailable=n.isUnavailable&&s.available?!1:n.isUnavailable)}}),i),{option1:[],option2:[],option3:[]})}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}}customElements.define("variant-selects",d);class l extends d{constructor(){super()}updateOptions(){const t=Array.from(this.querySelectorAll("fieldset"));this.options=t.map(e=>Array.from(e.querySelectorAll("input")).find(i=>i.checked).value)}}customElements.define("variant-radios",l)}if(!customElements.get("product-slider")){class d extends HTMLElement{constructor(){super(),this.addEventListener("change",this.setupProductGallery)}connectedCallback(){this.product_container=this.closest(".thb-product-detail"),this.thumbnail_container=this.product_container.querySelector(".product-thumbnail-container"),this.video_containers=this.querySelectorAll(".product-single__media-external-video--play"),this.setOptions(),this.init()}setOptions(){this.hide_variants=this.dataset.hideVariants=="true",this.thumbnails=this.thumbnail_container.querySelectorAll(".product-thumbnail"),this.prev_button=this.querySelector(".flickity-prev"),this.next_button=this.querySelector(".flickity-next"),this.options={wrapAround:!0,pageDots:!0,contain:!0,adaptiveHeight:!0,initialIndex:".is-initial-selected",prevNextButtons:!1,fade:!1,cellSelector:".product-images__slide.is-active"}}init(){this.flkty=new Flickity(this,this.options),this.selectedIndex=this.flkty.selectedIndex,this.setupEvents(),this.setupProductGallery()}reInit(a){this.flkty.destroy(),this.setOptions(),this.flkty=new Flickity(this,this.options),this.setupEvents(),this.selectedIndex=this.flkty.selectedIndex}setupEvents(){const a=this;if(this.prev_button){let t=this.prev_button.cloneNode(!0);this.prev_button.parentNode.append(t),this.prev_button.remove(),t.addEventListener("click",e=>{this.flkty.previous()}),t.addEventListener("keyup",e=>{this.flkty.previous(),e.preventDefault()})}if(this.next_button){let t=this.next_button.cloneNode(!0);this.next_button.parentNode.append(t),this.next_button.remove(),t.addEventListener("click",e=>{this.flkty.next()}),t.addEventListener("keyup",e=>{this.flkty.next(),e.preventDefault()})}this.video_containers.forEach(t=>{t.querySelector("button").addEventListener("click",function(){t.setAttribute("hidden","")})}),this.flkty.on("settle",function(t){a.selectedIndex=t}),this.flkty.on("change",t=>{let e=this.flkty.cells[a.selectedIndex].element,i=e.querySelector(".product-single__media"),s=Array.from(this.thumbnails).filter(n=>n.classList.contains("is-active")),r=s[t]?s[t]:s[0];this.thumbnails.forEach((n,o)=>{n.classList.remove("is-initial-selected")}),r.classList.add("is-initial-selected"),requestAnimationFrame(()=>{if(r.offsetParent===null)return;const n=r.offsetParent.clientHeight/2,o=r.offsetParent.clientWidth/2;r.parentElement.scrollTo({left:r.offsetLeft-o+r.clientWidth/2,top:r.offsetTop-n+r.clientHeight/2,behavior:"smooth"})}),i.classList.contains("product-single__media-external-video")?(i.dataset.provider==="youtube"?i.querySelector("iframe").contentWindow.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*"):i.dataset.provider==="vimeo"&&i.querySelector("iframe").contentWindow.postMessage(JSON.stringify({method:"pause"}),"*"),i.querySelector(".product-single__media-external-video--play").removeAttribute("hidden")):i.classList.contains("product-single__media-native-video")&&i.querySelector("video").pause()}),setTimeout(()=>{Array.from(this.thumbnails).filter(e=>e.clientWidth>0).forEach((e,i)=>{e.addEventListener("click",()=>{this.thumbnailClick(e,i)})})})}thumbnailClick(a,t){[].forEach.call(this.thumbnails,function(e){e.classList.remove("is-initial-selected")}),a.classList.add("is-initial-selected"),this.flkty.select(t)}setDraggable(a){this.flkty.options.draggable=a,this.flkty.updateDraggable()}selectCell(a){this.flkty.selectCell(a)}setupProductGallery(){this.querySelectorAll(".product-single__media-zoom").length&&this.setEventListeners()}buildItems(){return this.activeImages=Array.from(this.querySelectorAll(".product-images__slide.is-active .product-single__media-image")),this.activeImages.map(a=>{let t=[].indexOf.call(a.parentNode.parentNode.children,a.parentNode),e=a.querySelector(".product-single__media-zoom");return e.dataset.index=t,{src:e.getAttribute("href"),msrc:e.dataset.msrc,w:e.dataset.w,h:e.dataset.h}})}setEventListeners(){this.links=this.querySelectorAll(".product-single__media-zoom"),this.pswpElement=document.querySelectorAll(".pswp")[0],this.pswpOptions={maxSpreadZoom:2,loop:!1,allowPanToNext:!1,closeOnScroll:!1,showHideOpacity:!1,arrowKeys:!0,history:!1,captionEl:!1,fullscreenEl:!1,zoomEl:!1,shareEl:!1,counterEl:!0,arrowEl:!0,preloaderEl:!0,getThumbBoundsFn:()=>{const a=this.querySelector(".product-images__slide.is-selected"),t=window.pageYOffset||document.documentElement.scrollTop,e=a.getBoundingClientRect();return{x:e.left,y:e.top+t,w:e.width}}},this.links.forEach(a=>{a.addEventListener("click",t=>this.zoomClick(t,a))})}zoomClick(a,t){if(this.items=this.buildItems(),this.pswpOptions.index=parseInt(t.dataset.index,10),typeof PhotoSwipe<"u"){let e=new PhotoSwipe(this.pswpElement,PhotoSwipeUI_Default,this.items,this.pswpOptions);document.body.classList.add("open-lightbox"),e.listen("firstUpdate",function(){e.listen("destroy",function(){document.body.classList.remove("open-lightbox")}),e.listen("parseVerticalMargin",function(i){i.vGap={top:50,bottom:50}})}),e.init()}a.preventDefault()}}customElements.define("product-slider",d)}customElements.get("product-form")||customElements.define("product-form",class extends HTMLElement{constructor(){super()}connectedCallback(){this.sticky=this.dataset.sticky,this.form=document.getElementById(`product-form-${this.dataset.section}`),this.form.querySelector("[name=id]").disabled=!1,this.sticky||this.form.addEventListener("submit",this.onSubmitHandler.bind(this)),this.cartNotification=document.querySelector("cart-notification"),this.body=document.body,this.hideErrors=this.dataset.hideErrors==="true"}onSubmitHandler(l){if(l.preventDefault(),!this.form.reportValidity())return;const a=document.querySelectorAll(".single-add-to-cart-button");a.forEach(i=>{i.classList.contains("loading")||(i.setAttribute("aria-disabled",!0),i.classList.add("loading"))}),this.handleErrorMessage();const t={method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/javascript"}};let e=new FormData(this.form);e.append("sections",this.getSectionsToRender().map(i=>i.section)),e.append("sections_url",window.location.pathname),t.body=e,fetch(`${theme.routes.cart_add_url}`,t).then(i=>i.json()).then(i=>{if(i.status){dispatchCustomEvent("product:variant-error",{source:"product-form",productVariantId:e.get("id"),errors:i.description,message:i.message}),i.status===422&&document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0})),this.handleErrorMessage(i.description);return}this.renderContents(i),dispatchCustomEvent("cart:item-added",{product:i.hasOwnProperty("items")?i.items[0]:i})}).catch(i=>{console.error(i)}).finally(()=>{a.forEach(i=>{i.classList.remove("loading"),i.removeAttribute("aria-disabled")})})}getSectionsToRender(){return[{id:"Cart",section:"main-cart",selector:".thb-cart-form"},{id:"Cart-Drawer",section:"cart-drawer",selector:".cart-drawer"},{id:"cart-drawer-toggle",section:"cart-bubble",selector:".thb-item-count"}]}renderContents(l){this.getSectionsToRender().forEach(e=>{var s;if(!document.getElementById(e.id))return;const i=document.getElementById(e.id).querySelector(e.selector)||document.getElementById(e.id);i.innerHTML=this.getSectionInnerHTML(l.sections[e.section],e.selector),e.id==="Cart-Drawer"&&((s=document.getElementById("Cart-Drawer"))==null||s.removeProductEvent()),typeof Cart<"u"&&new Cart().renderContents(l)});let a=document.getElementById("Product-Drawer"),t=document.getElementById("Search-Drawer");t.classList.contains("active")&&t.classList.remove("active"),a&&a.contains(this)&&(a.classList.remove("active"),this.body.classList.remove("open-cc--product")),document.getElementById("Cart-Drawer")&&document.getElementById("Cart-Drawer").open()}getSectionInnerHTML(l,a=".shopify-section"){return new DOMParser().parseFromString(l,"text/html").querySelector(a).innerHTML}handleErrorMessage(l=!1){this.hideErrors||(this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(".product-form__error-message-wrapper"),this.errorMessageWrapper&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(".product-form__error-message"),this.errorMessageWrapper.toggleAttribute("hidden",!l),l&&(this.errorMessage.textContent=l)))}});if(!customElements.get("product-add-to-cart-sticky")){class d extends HTMLElement{constructor(){super(),this.animations_enabled=document.body.classList.contains("animations-true")&&typeof gsap<"u"}connectedCallback(){this.setupObservers(),this.setupToggle()}setupToggle(){const a=this.querySelector(".product-add-to-cart-sticky--inner"),t=this.querySelector(".product-add-to-cart-sticky--content");if(this.animations_enabled){const e=gsap.timeline({reversed:!0,paused:!0,onStart:()=>{a.classList.add("sticky-open")},onReverseComplete:()=>{a.classList.remove("sticky-open")}});e.set(t,{display:"block",height:"auto"},"start").from(t,{height:0,duration:.25},"start+=0.001"),a.addEventListener("click",function(){return e.reversed()?e.play():e.reverse(),!1})}else a.addEventListener("click",function(){return t.classList.toggle("active"),!1})}setupObservers(){let a=this,t=new IntersectionObserver(function(s){s.forEach(r=>{if(r.target===i&&(r.intersectionRatio>0?a.classList.remove("sticky--visible"):r.intersectionRatio==0&&a.formPassed&&a.classList.add("sticky--visible")),r.target===e){let n=e.getBoundingClientRect();r.intersectionRatio===0&&window.scrollY>n.top+n.height?(a.formPassed=!0,a.classList.add("sticky--visible")):r.intersectionRatio===1&&(a.formPassed=!1,a.classList.remove("sticky--visible"))}})},{threshold:[0,1]}),e=document.getElementById(`product-form-${this.dataset.section}`),i=document.getElementById("footer");a.formPassed=!1,t.observe(e),t.observe(i)}}customElements.define("product-add-to-cart-sticky",d)}if(!customElements.get("side-panel-links")){class d extends HTMLElement{constructor(){super(),this.links=this.querySelectorAll("button"),this.drawer=document.getElementById("Product-Information-Drawer"),this.buttons=this.drawer.querySelector(".side-panel-content--tabs"),this.panels=this.drawer.querySelector(".side-panel-content--inner").querySelectorAll(".side-panel-content--tab-panel"),this.body=document.body}connectedCallback(){this.setupObservers()}disconnectedCallback(){}setupObservers(){this.links.forEach((a,t)=>{a.addEventListener("click",e=>{this.body.classList.add("open-cc"),this.buttons.toggleActiveClass(t),this.drawer.classList.add("active")})})}}customElements.define("side-panel-links",d)}typeof addIdToRecentlyViewed<"u"&&addIdToRecentlyViewed();
//# sourceMappingURL=components--product.js.map
