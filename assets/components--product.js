if(!customElements.get("variant-selects")){class d extends HTMLElement{constructor(){super(),this.sticky=this.dataset.sticky,this.updateUrl=this.dataset.updateUrl==="true",this.isDisabledFeature=this.dataset.isDisabled,this.addEventListener("change",this.onVariantChange),this.other=Array.from(document.querySelectorAll("variant-selects")).filter(e=>e!=this),this.productWrapper=this.closest(".thb-product-detail"),this.productSlider=this.productWrapper.querySelector(".product-images"),this.hideVariants=this.dataset.hideVariants==="true"}connectedCallback(){this.updateOptions(),this.updateMasterId(),this.setDisabled(),this.setImageSet()}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updatePickupAvailability(),this.removeErrorMessage(),this.updateVariantText(),this.setDisabled(),p(this.dataset.url).then(e=>{!this.currentVariant||!e?(this.toggleAddButton(!0,"",!0),this.setUnavailable(!e)):(this.updateMedia(),this.updateUrl&&this.updateURL(),this.updateVariantInput(),this.renderProductInfo())}),this.updateOther(),dispatchCustomEvent("product:variant-change",{variant:this.currentVariant,sectionId:this.dataset.section})}updateOptions(){this.fieldsets=Array.from(this.querySelectorAll("fieldset")),this.options=[],this.fieldsets.forEach((e,t)=>{e.querySelector("select")?this.options.push(e.querySelector("select").value):e.querySelectorAll("input").length&&this.options.push(e.querySelector("input:checked").value)})}updateVariantText(){Array.from(this.querySelectorAll("fieldset")).forEach((t,r)=>{let i=t.querySelector(".form__label__value");i&&(i.innerHTML=this.options[r])})}updateMasterId(){this.currentVariant=this.getVariantData().find(e=>!e.options.map((t,r)=>this.options[r]===t).includes(!1))}updateOther(){if(this.dataset.updateUrl!=="false"&&this.other.length){let e=this.other[0].querySelectorAll("fieldset"),t=Array.from(e);this.options.forEach((r,i)=>{t[i].querySelector("select")?t[i].querySelector("select").value=r:t[i].querySelectorAll("input").length&&(t[i].querySelector(`input[value='${r}']`).checked=!0)}),this.other[0].updateOptions(),this.other[0].updateMasterId(),this.other[0].updateVariantText(),this.other[0].setDisabled()}}updateMedia(){if(!this.currentVariant||!this.currentVariant.featured_media)return;let e=this.productWrapper.querySelector(".product-thumbnail-container");this.setActiveMedia(`#Slide-${this.dataset.section}-${this.currentVariant.featured_media.id}`,`#Thumb-${this.dataset.section}-${this.currentVariant.featured_media.id}`,this.productSlider,e)}setActiveMedia(e,t,r,i){let s=Flickity.data(r),n=r.querySelector(e);if(s&&this.hideVariants){if(r.querySelector(".product-images__slide.is-initial-selected")&&r.querySelector(".product-images__slide.is-initial-selected").classList.remove("is-initial-selected"),[].forEach.call(r.querySelectorAll(".product-images__slide-item--variant"),function(o){o.classList.remove("is-active")}),n.classList.add("is-active"),n.classList.add("is-initial-selected"),this.setImageSetMedia(),i){let o=i.querySelector(t);i.querySelector(".product-thumbnail.is-initial-selected")&&i.querySelector(".product-thumbnail.is-initial-selected").classList.remove("is-initial-selected"),[].forEach.call(i.querySelectorAll(".product-images__slide-item--variant"),function(c){c.classList.remove("is-active")}),o.classList.add("is-active"),o.classList.add("is-initial-selected")}r.reInit(this.imageSetIndex),r.selectCell(e)}else s&&r.selectCell(e)}updateURL(){!this.currentVariant||this.dataset.updateUrl==="false"||window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateShareUrl(){const e=document.getElementById(`Share-${this.dataset.section}`);e&&e.updateUrl(`${window.shopUrl}${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment`).forEach(t=>{const r=t.querySelector('input[name="id"]');r.value=this.currentVariant.id,r.dispatchEvent(new Event("change",{bubbles:!0}))})}updatePickupAvailability(){const e=document.querySelector(".pickup-availability-wrapper");e&&(this.currentVariant&&this.currentVariant.available?e.fetchAvailability(this.currentVariant.id):(e.removeAttribute("available"),e.innerHTML=""))}removeErrorMessage(){const e=this.closest("section");if(!e)return;const t=e.querySelector("product-form");t&&t.handleErrorMessage()}getSectionsToRender(){return[`price-${this.dataset.section}`,`price-${this.dataset.section}--total`,`price-${this.dataset.section}--sticky`,`product-image-${this.dataset.section}--sticky`,`inventory-${this.dataset.section}`,`sku-${this.dataset.section}`,`quantity-${this.dataset.section}`]}renderProductInfo(){let e=this.getSectionsToRender();fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then(t=>t.text()).then(t=>{const r=new DOMParser().parseFromString(t,"text/html");e.forEach(i=>{const s=document.getElementById(i),n=r.getElementById(i);n&&s&&(s.innerHTML=n.innerHTML);const o=document.getElementById(i),c=document.getElementById(i+"--sticky");o&&o.classList.remove("visibility-hidden"),c&&c.classList.remove("visibility-hidden")}),this.toggleAddButton(!this.currentVariant.available,window.theme.variantStrings.soldOut)})}toggleAddButton(e=!0,t=!1,r=!0){const i=document.getElementById(`product-form-${this.dataset.section}`);if(!i)return;const s=i.closest(".product-form").getAttribute("template"),n=document.querySelectorAll(".single-add-to-cart-button");n&&n.forEach(o=>{const c=o.querySelector(".single-add-to-cart-button--text");c&&(e?(o.setAttribute("disabled","disabled"),t&&(c.textContent=t)):(o.removeAttribute("disabled"),o.classList.remove("loading"),s!=null&&s.includes("pre-order")?c.textContent=window.theme.variantStrings.preOrder:c.textContent=window.theme.variantStrings.addToCart))})}setUnavailable(e=!1){const t=document.querySelectorAll(".single-add-to-cart-button"),r=document.getElementById(`price-${this.dataset.section}`),i=document.getElementById(`price-${this.dataset.section}--sticky`);t.forEach(s=>{const n=s.querySelector(".single-add-to-cart-button--text");s&&(n.textContent=e?window.theme.variantStrings.maxLimit:window.theme.variantStrings.unavailable,s.classList.add("sold-out"))}),r&&!e&&r.classList.add("visibility-hidden"),i&&!e&&i.classList.add("visibility-hidden")}setDisabled(){if(this.isDisabledFeature!="true")return;const e=this.getVariantData();if(e){let t=!1;if(this.currentVariant)t=this.currentVariant.options.map((i,s)=>({value:i,index:`option${s+1}`}));else{let i=e.find(s=>s.option1===this.options[0]);if(i)t=[{value:this.options[0],index:"option1"},{value:i.option2,index:"option2"}];else return}const r=this.createAvailableOptionsTree(e,t);this.fieldsets.forEach((i,s)=>{const n=Object.values(r)[s];n&&(i.querySelector("select")?n.forEach((o,c)=>{o.isUnavailable?i.querySelector("option[value="+JSON.stringify(o.value)+"]").disabled=!0:i.querySelector("option[value="+JSON.stringify(o.value)+"]").disabled=!1}):i.querySelectorAll("input").length&&i.querySelectorAll("input").forEach((o,c)=>{o.classList.toggle("is-disabled",n[c].isUnavailable)}))})}return!0}getImageSetName(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-$/,"").replace(/^-/,"")}setImageSet(){if(!this.productSlider)return;let e=this.productSlider.querySelector("[data-set-name]");e&&(this.imageSetName=e.dataset.setName,this.imageSetIndex=this.querySelector('.product-form__input[data-handle="'+this.imageSetName+'"]').dataset.index,this.dataset.imageSetIndex=this.imageSetIndex,this.setImageSetMedia())}setImageSetMedia(){if(!this.imageSetIndex)return;let e=this.getImageSetName(this.currentVariant[this.imageSetIndex]),t=this.imageSetName+"_"+e,r=this.productWrapper.querySelectorAll(`.product-images__slide[data-set-name="${this.imageSetName}"]`),i=this.productWrapper.querySelectorAll(`.product-thumbnail[data-set-name="${this.imageSetName}"]`);this.hideVariants&&(this.productWrapper.querySelectorAll(".product-images__slide").forEach(s=>{s.dataset.group&&s.dataset.group!==t&&s.classList.remove("is-active")}),r.forEach(s=>{s.classList.toggle("is-active",s.dataset.group===t)}),this.productWrapper.querySelectorAll(".product-thumbnail").forEach(s=>{s.dataset.group&&s.dataset.group!==t&&s.classList.remove("is-active")}),i.forEach(s=>{s.classList.toggle("is-active",s.dataset.group===t)}))}createAvailableOptionsTree(e,t){return e.reduce((r,i)=>(Object.keys(r).forEach(s=>{if(i[s]===null)return;let n=r[s].find(u=>u.value===i[s]);typeof n>"u"&&(n={value:i[s],isUnavailable:!0},r[s].push(n));const o=t.find(({value:u,index:h})=>h==="option1"),c=t.find(({value:u,index:h})=>h==="option2");switch(s){case"option1":n.isUnavailable=n.isUnavailable&&i.available?!1:n.isUnavailable;break;case"option2":o&&i.option1===o.value&&(n.isUnavailable=n.isUnavailable&&i.available?!1:n.isUnavailable);break;case"option3":o&&i.option1===o.value&&c&&i.option2===c.value&&(n.isUnavailable=n.isUnavailable&&i.available?!1:n.isUnavailable)}}),r),{option1:[],option2:[],option3:[]})}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[data-json-type="variant-data"]').textContent),this.variantData}}customElements.define("variant-selects",d);class l extends d{constructor(){super()}updateOptions(){const e=Array.from(this.querySelectorAll("fieldset"));this.options=e.map(t=>Array.from(t.querySelectorAll("input")).find(r=>r.checked).value)}}customElements.define("variant-radios",l)}if(!customElements.get("product-slider")){class d extends HTMLElement{constructor(){super(),this.addEventListener("change",this.setupProductGallery)}connectedCallback(){this.product_container=this.closest(".thb-product-detail"),this.thumbnail_container=this.product_container.querySelector(".product-thumbnail-container"),this.video_containers=this.querySelectorAll(".product-single__media-external-video--play"),this.setOptions(),this.init()}setOptions(){this.hide_variants=this.dataset.hideVariants=="true",this.thumbnails=this.thumbnail_container.querySelectorAll(".product-thumbnail"),this.prev_button=this.querySelector(".flickity-prev"),this.next_button=this.querySelector(".flickity-next"),this.options={wrapAround:!0,pageDots:!0,contain:!0,adaptiveHeight:!0,initialIndex:".is-initial-selected",prevNextButtons:!1,fade:!1,cellSelector:".product-images__slide.is-active"}}init(){this.flkty=new Flickity(this,this.options),this.selectedIndex=this.flkty.selectedIndex,this.setupEvents(),this.setupProductGallery()}reInit(a){this.flkty.destroy(),this.setOptions(),this.flkty=new Flickity(this,this.options),this.setupEvents(),this.selectedIndex=this.flkty.selectedIndex}setupEvents(){const a=this;if(this.prev_button){let e=this.prev_button.cloneNode(!0);this.prev_button.parentNode.append(e),this.prev_button.remove(),e.addEventListener("click",t=>{this.flkty.previous()}),e.addEventListener("keyup",t=>{this.flkty.previous(),t.preventDefault()})}if(this.next_button){let e=this.next_button.cloneNode(!0);this.next_button.parentNode.append(e),this.next_button.remove(),e.addEventListener("click",t=>{this.flkty.next()}),e.addEventListener("keyup",t=>{this.flkty.next(),t.preventDefault()})}this.video_containers.forEach(e=>{e.querySelector("button").addEventListener("click",function(){e.setAttribute("hidden","")})}),this.flkty.on("settle",function(e){a.selectedIndex=e}),this.flkty.on("change",e=>{let t=this.flkty.cells[a.selectedIndex].element,r=t.querySelector(".product-single__media"),i=Array.from(this.thumbnails).filter(n=>n.classList.contains("is-active")),s=i[e]?i[e]:i[0];this.thumbnails.forEach((n,o)=>{n.classList.remove("is-initial-selected")}),s.classList.add("is-initial-selected"),requestAnimationFrame(()=>{if(s.offsetParent===null)return;const n=s.offsetParent.clientHeight/2,o=s.offsetParent.clientWidth/2;s.parentElement.scrollTo({left:s.offsetLeft-o+s.clientWidth/2,top:s.offsetTop-n+s.clientHeight/2,behavior:"smooth"})}),r.classList.contains("product-single__media-external-video")?(r.dataset.provider==="youtube"?r.querySelector("iframe").contentWindow.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*"):r.dataset.provider==="vimeo"&&r.querySelector("iframe").contentWindow.postMessage(JSON.stringify({method:"pause"}),"*"),r.querySelector(".product-single__media-external-video--play").removeAttribute("hidden")):r.classList.contains("product-single__media-native-video")&&r.querySelector("video").pause()}),setTimeout(()=>{Array.from(this.thumbnails).filter(t=>t.clientWidth>0).forEach((t,r)=>{t.addEventListener("click",()=>{this.thumbnailClick(t,r)})})})}thumbnailClick(a,e){[].forEach.call(this.thumbnails,function(t){t.classList.remove("is-initial-selected")}),a.classList.add("is-initial-selected"),this.flkty.select(e)}setDraggable(a){this.flkty.options.draggable=a,this.flkty.updateDraggable()}selectCell(a){this.flkty.selectCell(a)}setupProductGallery(){this.querySelectorAll(".product-single__media-zoom").length&&this.setEventListeners()}buildItems(){return this.activeImages=Array.from(this.querySelectorAll(".product-images__slide.is-active .product-single__media-image")),this.activeImages.map(a=>{let e=[].indexOf.call(a.parentNode.parentNode.children,a.parentNode),t=a.querySelector(".product-single__media-zoom");return t.dataset.index=e,{src:t.getAttribute("href"),msrc:t.dataset.msrc,w:t.dataset.w,h:t.dataset.h}})}setEventListeners(){this.links=this.querySelectorAll(".product-single__media-zoom"),this.pswpElement=document.querySelectorAll(".pswp")[0],this.pswpOptions={maxSpreadZoom:2,loop:!1,allowPanToNext:!1,closeOnScroll:!1,showHideOpacity:!1,arrowKeys:!0,history:!1,captionEl:!1,fullscreenEl:!1,zoomEl:!1,shareEl:!1,counterEl:!0,arrowEl:!0,preloaderEl:!0,getThumbBoundsFn:()=>{const a=this.querySelector(".product-images__slide.is-selected"),e=window.pageYOffset||document.documentElement.scrollTop,t=a.getBoundingClientRect();return{x:t.left,y:t.top+e,w:t.width}}},this.links.forEach(a=>{a.addEventListener("click",e=>this.zoomClick(e,a))})}zoomClick(a,e){if(this.items=this.buildItems(),this.pswpOptions.index=parseInt(e.dataset.index,10),typeof PhotoSwipe<"u"){let t=new PhotoSwipe(this.pswpElement,PhotoSwipeUI_Default,this.items,this.pswpOptions);document.body.classList.add("open-lightbox"),t.listen("firstUpdate",function(){t.listen("destroy",function(){document.body.classList.remove("open-lightbox")}),t.listen("parseVerticalMargin",function(r){r.vGap={top:50,bottom:50}})}),t.init()}a.preventDefault()}}customElements.define("product-slider",d)}customElements.get("product-form")||customElements.define("product-form",class extends HTMLElement{constructor(){super()}connectedCallback(){this.sticky=this.dataset.sticky,this.form=document.getElementById(`product-form-${this.dataset.section}`),this.form.querySelector("[name=id]").disabled=!1,this.sticky||this.form.addEventListener("submit",this.onSubmitHandler.bind(this)),this.cartNotification=document.querySelector("cart-notification"),this.body=document.body,this.hideErrors=this.dataset.hideErrors==="true"}onSubmitHandler(l){if(l.preventDefault(),!this.form.reportValidity())return;const a=document.querySelectorAll(".single-add-to-cart-button");a.forEach(r=>{r.classList.contains("loading")||(r.setAttribute("aria-disabled",!0),r.classList.add("loading"))}),this.handleErrorMessage();const e={method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/javascript"}};let t=new FormData(this.form);t.append("sections",this.getSectionsToRender().map(r=>r.section)),t.append("sections_url",window.location.pathname),e.body=t,p(this.form.dataset.url).then(r=>{if(!r){a.forEach(i=>{i.classList.remove("loading"),i.setAttribute("aria-disabled",!0),i.setAttribute("disabled","disabled");const s=i.querySelector(".single-add-to-cart-button--text");s&&(s.textContent=window.theme.variantStrings.maxLimit)});return}fetch(`${theme.routes.cart_add_url}`,e).then(i=>i.json()).then(i=>{if(i.status){dispatchCustomEvent("product:variant-error",{source:"product-form",productVariantId:t.get("id"),errors:i.description,message:i.message}),i.status===422&&document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0})),this.handleErrorMessage(i.description);return}this.renderContents(i),dispatchCustomEvent("cart:item-added",{product:i.hasOwnProperty("items")?i.items[0]:i})}).catch(i=>{console.error(i)}).finally(()=>{a.forEach(i=>{i.classList.remove("loading"),i.removeAttribute("aria-disabled")}),p(this.form.dataset.url).then(i=>{if(!i){a.forEach(s=>{s.setAttribute("disabled","disabled");const n=s.querySelector(".single-add-to-cart-button--text");n&&(n.textContent=window.theme.variantStrings.maxLimit)});return}})})})}getSectionsToRender(){return[{id:"Cart",section:"main-cart",selector:".thb-cart-form"},{id:"Cart-Drawer",section:"cart-drawer",selector:".cart-drawer"},{id:"cart-drawer-toggle",section:"cart-bubble",selector:".thb-item-count"}]}renderContents(l){this.getSectionsToRender().forEach(t=>{var i;if(!document.getElementById(t.id))return;const r=document.getElementById(t.id).querySelector(t.selector)||document.getElementById(t.id);r.innerHTML=this.getSectionInnerHTML(l.sections[t.section],t.selector),t.id==="Cart-Drawer"&&((i=document.getElementById("Cart-Drawer"))==null||i.removeProductEvent()),typeof Cart<"u"&&new Cart().renderContents(l)});let a=document.getElementById("Product-Drawer"),e=document.getElementById("Search-Drawer");e.classList.contains("active")&&e.classList.remove("active"),a&&a.contains(this)&&(a.classList.remove("active"),this.body.classList.remove("open-cc--product")),document.getElementById("Cart-Drawer")&&document.getElementById("Cart-Drawer").open()}getSectionInnerHTML(l,a=".shopify-section"){return new DOMParser().parseFromString(l,"text/html").querySelector(a).innerHTML}handleErrorMessage(l=!1){this.hideErrors||(this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(".product-form__error-message-wrapper"),this.errorMessageWrapper&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(".product-form__error-message"),this.errorMessageWrapper.toggleAttribute("hidden",!l),l&&(this.errorMessage.textContent=l)))}});if(!customElements.get("product-add-to-cart-sticky")){class d extends HTMLElement{constructor(){super(),this.animations_enabled=document.body.classList.contains("animations-true")&&typeof gsap<"u"}connectedCallback(){this.setupObservers(),this.setupToggle()}setupToggle(){const a=this.querySelector(".product-add-to-cart-sticky--inner"),e=this.querySelector(".product-add-to-cart-sticky--content");if(this.animations_enabled){const t=gsap.timeline({reversed:!0,paused:!0,onStart:()=>{a.classList.add("sticky-open")},onReverseComplete:()=>{a.classList.remove("sticky-open")}});t.set(e,{display:"block",height:"auto"},"start").from(e,{height:0,duration:.25},"start+=0.001"),a.addEventListener("click",function(){return t.reversed()?t.play():t.reverse(),!1})}else a.addEventListener("click",function(){return e.classList.toggle("active"),!1})}setupObservers(){let a=this,e=new IntersectionObserver(function(i){i.forEach(s=>{if(s.target===r&&(s.intersectionRatio>0?a.classList.remove("sticky--visible"):s.intersectionRatio==0&&a.formPassed&&a.classList.add("sticky--visible")),s.target===t){let n=t.getBoundingClientRect();s.intersectionRatio===0&&window.scrollY>n.top+n.height?(a.formPassed=!0,a.classList.add("sticky--visible")):s.intersectionRatio===1&&(a.formPassed=!1,a.classList.remove("sticky--visible"))}})},{threshold:[0,1]}),t=document.getElementById(`product-form-${this.dataset.section}`),r=document.getElementById("footer");a.formPassed=!1,e.observe(t),e.observe(r)}}customElements.define("product-add-to-cart-sticky",d)}if(!customElements.get("side-panel-links")){class d extends HTMLElement{constructor(){super(),this.links=this.querySelectorAll("button"),this.drawer=document.getElementById("Product-Information-Drawer"),this.buttons=this.drawer.querySelector(".side-panel-content--tabs"),this.panels=this.drawer.querySelector(".side-panel-content--inner").querySelectorAll(".side-panel-content--tab-panel"),this.body=document.body}connectedCallback(){this.setupObservers()}disconnectedCallback(){}setupObservers(){this.links.forEach((a,e)=>{a.addEventListener("click",t=>{this.body.classList.add("open-cc"),this.buttons.toggleActiveClass(e),this.drawer.classList.add("active")})})}}customElements.define("side-panel-links",d)}async function p(d){return purchasable=await fetch(d+"?view=purchase-limit").then(l=>l.text()).then(l=>{const a=document.createElement("div");a.innerHTML=l;const e=JSON.parse(a.querySelector("script").textContent);return!((e==null?void 0:e.in_cart)==="true"&&parseInt(e==null?void 0:e.limit)===1)})}typeof addIdToRecentlyViewed<"u"&&addIdToRecentlyViewed();
//# sourceMappingURL=components--product.js.map
