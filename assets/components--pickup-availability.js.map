{"version":3,"file":"components--pickup-availability.js","sources":["../theming/js/components/pickup-availability.js"],"sourcesContent":["if (!customElements.get('pickup-availability')) {\n  customElements.define('pickup-availability', class PickupAvailability extends HTMLElement {\n    constructor() {\n      super();\n\n      if (!this.hasAttribute('available')) return;\n\n      this.onClickRefreshList = this.onClickRefreshList.bind(this);\n      this.fetchAvailability(this.dataset.variantId);\n\n    }\n\n    fetchAvailability(variantId) {\n      let rootUrl = this.dataset.rootUrl;\n      if (!rootUrl.endsWith(\"/\")) {\n        rootUrl = rootUrl + \"/\";\n      }\n      const variantSectionUrl = `${rootUrl}variants/${variantId}/?section_id=pickup-availability`;\n\n      fetch(variantSectionUrl)\n      .then(response => response.text())\n      .then(text => {\n        const sectionInnerHTML = new DOMParser()\n        .parseFromString(text, 'text/html')\n        .querySelector('.shopify-section');\n        this.renderPreview(sectionInnerHTML);\n\n      })\n      .catch(e => {\n        const button = this.querySelector('button');\n        if (button) button.removeEventListener('click', this.onClickRefreshList);\n        this.renderError();\n      });\n    }\n\n    onClickRefreshList(evt) {\n      this.fetchAvailability(this.dataset.variantId);\n    }\n\n    renderError() {\n      this.innerHTML = '';\n\n      if (this.querySelector('button')) {\n        this.querySelector('button').addEventListener('click', this.onClickRefreshList);\n      }\n    }\n\n    renderPreview(sectionInnerHTML) {\n      const drawer = document.querySelector('.pickup-availability-drawer');\n      if (drawer) drawer.remove();\n      if (!sectionInnerHTML.querySelector('.pickup-availability-information')) {\n        this.innerHTML = \"\";\n        this.removeAttribute('available');\n        return;\n      }\n\n      this.innerHTML = sectionInnerHTML.querySelector('.pickup-availability-information').innerHTML;\n      this.setAttribute('available', '');\n\n      document.getElementById('Pickup-Availability').innerHTML = sectionInnerHTML.querySelector('.side-availability').innerHTML;\n\n      const button = this.querySelector('button');\n      if (button) button.addEventListener('click', (evt) => {\n        document.getElementById('Pickup-Availability').classList.toggle(\"active\");\n        document.getElementsByTagName(\"body\")[0].classList.toggle('open-cc');\n\n        evt.preventDefault();\n      });\n    }\n  });\n}\n"],"names":["variantId","rootUrl","variantSectionUrl","response","text","sectionInnerHTML","e","button","evt","drawer"],"mappings":"AAAK,eAAe,IAAI,qBAAqB,GAC3C,eAAe,OAAO,sBAAuB,cAAiC,WAAY,CACxF,aAAc,CACZ,MAAO,EAEF,KAAK,aAAa,WAAW,IAElC,KAAK,mBAAqB,KAAK,mBAAmB,KAAK,IAAI,EAC3D,KAAK,kBAAkB,KAAK,QAAQ,SAAS,EAEnD,CAEI,kBAAkBA,EAAW,CAC3B,IAAIC,EAAU,KAAK,QAAQ,QACtBA,EAAQ,SAAS,GAAG,IACvBA,EAAUA,EAAU,KAEtB,MAAMC,EAAoB,GAAGD,CAAO,YAAYD,CAAS,mCAEzD,MAAME,CAAiB,EACtB,KAAKC,GAAYA,EAAS,KAAM,CAAA,EAChC,KAAKC,GAAQ,CACZ,MAAMC,EAAmB,IAAI,UAAS,EACrC,gBAAgBD,EAAM,WAAW,EACjC,cAAc,kBAAkB,EACjC,KAAK,cAAcC,CAAgB,CAEpC,CAAA,EACA,MAAMC,GAAK,CACV,MAAMC,EAAS,KAAK,cAAc,QAAQ,EACtCA,GAAQA,EAAO,oBAAoB,QAAS,KAAK,kBAAkB,EACvE,KAAK,YAAa,CAC1B,CAAO,CACP,CAEI,mBAAmBC,EAAK,CACtB,KAAK,kBAAkB,KAAK,QAAQ,SAAS,CACnD,CAEI,aAAc,CACZ,KAAK,UAAY,GAEb,KAAK,cAAc,QAAQ,GAC7B,KAAK,cAAc,QAAQ,EAAE,iBAAiB,QAAS,KAAK,kBAAkB,CAEtF,CAEI,cAAcH,EAAkB,CAC9B,MAAMI,EAAS,SAAS,cAAc,6BAA6B,EAEnE,GADIA,GAAQA,EAAO,OAAQ,EACvB,CAACJ,EAAiB,cAAc,kCAAkC,EAAG,CACvE,KAAK,UAAY,GACjB,KAAK,gBAAgB,WAAW,EAChC,MACR,CAEM,KAAK,UAAYA,EAAiB,cAAc,kCAAkC,EAAE,UACpF,KAAK,aAAa,YAAa,EAAE,EAEjC,SAAS,eAAe,qBAAqB,EAAE,UAAYA,EAAiB,cAAc,oBAAoB,EAAE,UAEhH,MAAME,EAAS,KAAK,cAAc,QAAQ,EACtCA,GAAQA,EAAO,iBAAiB,QAAUC,GAAQ,CACpD,SAAS,eAAe,qBAAqB,EAAE,UAAU,OAAO,QAAQ,EACxE,SAAS,qBAAqB,MAAM,EAAE,CAAC,EAAE,UAAU,OAAO,SAAS,EAEnEA,EAAI,eAAgB,CAC5B,CAAO,CACP,CACA,CAAG"}